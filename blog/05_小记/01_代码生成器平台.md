# 笔记之代码生成器平台
## 代码生成器平台 第一期
第一期主要是项目的介绍，告诉我们要做什么样的项目，包括需求分析，技术选型
[相关链接](https://www.codefather.cn/course/1790980795074654209/section/1790994867614691330?contentType=text&tabKey=videoList&type=) 终极目标：在线制作代码生成器，分为三个阶段
1. 阶段一：学习如何制作脚手架 （代码生成器）**1~3期**
2. 阶段二：将制作脚手架的流程用代码实现出来 （脚手架制作工具）
3. 阶段三：将脚手架制作工具上云，提供Web界面进行操作
## 代码生成器平台 第二期
第二期的核心任务就是**完成代码生成器的核心流程**，我认为的核心流程如下：
1. 需要一个原始的工程文件
2. 分析原始工程文件哪些是固定不变的，哪些是可以扩展的，可以扩展的利用动态模版技术，固定不变的直接复制粘贴
3. 将原始的工程文件变成一个代码生成器源包，即动态模版文件 + 静态文件 
4. 代码生成器源包 + 相关的参数 == 原始工程文件的变种。比如输出格式变化，代码文件的注释变化等等
## 代码生成器平台 第三期
第三期的核心任务就是**提供CLI**，为用户与程序提供一个交互的手段。保证用户可以输入一些参数生成定制化的代码
### 课堂记录
- 对于自己没有使用过的技术，必须进行充分的调研，需要花费大量的时间
- 对于新技术，看官方文档，如果官方文档看不懂才去看视频教程，看文本教程，问GPT
- 快速入门 ==> 实用（核心）功能
	- 核心功能从快速入门的案例中提取
- 验证 交互式 + 必需参数
- 学习一下命令设计模式 实践一下
- 明确需求很重要 需求，需求，需求！
## 代码生成器平台 第四期
第四期的核心任务：拆分脚手架制作工具的需求，分为三个阶段，并完成第一个阶段的任务。
1. 在假设源包制作好的基础上，实现脚手架制作工具的主题流程
2. 优化代码，增加元信息配置文件的能力
3. 优化功能，源包如何使用脚手架制作工具生成
### 课堂记录
- 脚手架制作工具做的事情：  元信息配置文件 +制作工具（源包的配置，模型对象的配置） ==>   源包的生成 + 模型对象 + 脚手架核心逻辑的生成
- 面对需求束手无策时，需要拆解需求 分阶段进行需求分析
- 先跑通核心流程，在优化和增加功能
- 当你不知道怎么做的时候，百度，问AI，借鉴别人的，参考别人 + 自己的需求
- **验证**：写文件的时候，如果文件不存在就不会自动创建吗？
- 插件转换：JSON对象转换为Java类 GsonFormatPlus RoboPOJOGenerator
- JSON 数据转换为Java对象是有性能损耗的
- 疑问：反射能动态生成代码？
- IDEA有个好用的小功能，FindUsage
### 我的收获
1. 需求分析，需求拆解很重要！
2. 人无完人，总会遇到自己没有接触过的东西，不会东西，这个时候需要有一套方法论指导自己学习新东西，或者解决没有接触过的问题。核心就是：模仿借鉴 + 结合实际
## 代码生成器平台 第五期
1. 可移植性优化 sourceRootPath 换个环境看看是否可以正常执行
2. 功能优化 增加说明文档（脚手架）
3. 健壮性优化 特殊条件下，能够稳定运行 元信息配置文件的校验
4. 可扩展性优化 让别人认为好修改代码，方便增加功能。尽量不要出现魔法值 模版方法模式

- 空间优化 产物包
- 扩展点：.git 代码托管
- 异常最好做成枚举的 可以有一个兜底值
- 量化代码复杂度：圈复杂度 < 10 插件：MetricsReloaded
- **验证**：static方法不能被重写，为什么？
    - 重写的目的是利用多态，而多态需要基于对象而非类，而静态方法属于类而非对象
## 代码生成器平台 1~5期编码实现
我觉得可以分为三个大的步骤：
1. 项目的初始化 30min
2. 手动制作代码生成器 1h
    - 准备一个初始工程文件
    - 定义一些概念
1. 利用工具制作代码生成器（假定源包已存在）1h
### 项目初始化
1. 导入依赖
    - 工具包 Hutool 实用的工具类
    - 动态代码模板 freemarker  负责代码生成的核心逻辑
    - 命令行框架 picocli 负责提供CLI式的访问方式
### 手动制作代码生成器（ACM）
1. 先确认哪些文件需要动态生成，哪些文件可以直接复制
2. 定义数据模型（动态文件需要的）即我们可以定制化的部分
3. 制作源包（静态文件 + 动态文件）
4. 测试一下FreeMarker是否可以正常工作 简单测试 + 自带的动态文件测试
5. 利用源包 + 数据模型 生成定制化的工程代码
6. 为这个逻辑提供命令行的访问方式

- **问题1**：文件路径问题 反斜杠与斜杠 以及 路径开头是否有/ 这些问题
- **问题2**：打成Jar包后，无法直接遍历Jar包中的文件了
- **问题3**：不能以文件的形式，访问Jar包中内容
## 代码生成器 第六期 核心篇
### 课堂记录
- 具体的例子驱动开发
- 需求驱动，任务驱动
- 聚合搜索项目中存在ES的教程
- 从具体的例子中分析通用的能力，有点测试驱动开发哪个味道，这样写出来的代码可以复用，可以扩展
- 学习：了解一下分布式Session在Java中的实现
- 元信息配置文件是描述代码生成器的各个方面，其中就包括了数据模型长什么样
- 抽象能力的培养：不断的做，不断写设计文档，不断的学习其他的项目
- 基于具体的例子开发，如果没有任何想法的话，一定要基于具体而非抽象
- 越使用，越亲近，越熟悉
- **核心**：从个例中梳理出通用需求的能力

### 通用功能分析
1. 利用制作工具自动帮我们将原始文件"挖坑"变成动态文件
2. 利用一个参数去生成多个文件，或者不生成多个文件 在文件配置中增加一个新的分组类型
3. 用一个参数控制某个文件是否生成 在文件配置中增加一个属性condition
4. 用一个参数管理是否开启某个配置，如果开启，就需要另外的一组配置，类似嵌套对象
5. 针对分析好的需求进行排期，进行优先级排序，由简单到复杂